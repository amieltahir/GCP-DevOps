Task 1. Create a project jumphost instance
You will use this instance to perform maintenance for the project.

Requirements:

Name the instance Instance name.
Create the instance in the ZONE zone.
Use an e2-micro machine type.
Use the default image type (Debian Linux).


gcloud compute instances create nucleus-jumphost-198 --zone=us-east1-b --machine-type=e2-micro

Task 2. Set up an HTTP load balancer
You will serve the site via nginx web servers, but you want to ensure that the environment is fault-tolerant. Create an HTTP load balancer with a managed instance group of 2 nginx web servers. Use the following code to configure the web servers; the team will replace this with their own configuration later.

cat << EOF > startup.sh
#! /bin/bash
apt-get update
apt-get install -y nginx
service nginx start
sed -i -- 's/nginx/Google Cloud Platform - '"\$HOSTNAME"'/' /var/www/html/index.nginx-debian.html
EOF

gcloud compute instance-templates create global-template   --machine-type=e2-medium   --image-family=debian-11   --image-project=debian-cloud --tags=allow-health-check  --metadata=startup-script='#! /bin/bash
apt-get update
apt-get install -y nginx
service nginx start
HOSTNAME=$(hostname)
sed -i "s/Welcome to nginx!/Google Cloud Platform - $HOSTNAME/" /var/www/html/index.nginx-debian.html'


gcloud compute instance-groups managed create global-mig --base-instance-name=web-server --template=global-template --size=2 --zone=us-east1-b

gcloud compute firewall-rules create permit-tcp-rule-123 --direction=INGRESS --priority=1000 --network=default --action=ALLOW --rules=tcp:80 --source-ranges=0.0.0.0/0 --target-tags=allow-health-check

gcloud compute health-checks create http global-health-check --port 80

 gcloud compute addresses create lb-ipv4-1 \
  --ip-version=IPV4 \
  --global

gcloud compute addresses describe lb-ipv4-1 \
  --format="get(address)" \
  --global
35.244.178.211

gcloud compute backend-services create global-backend-service --protocol=HTTP --health-checks=global-health-check --port-name=http --global

gcloud compute instance-groups managed set-named-ports global-mig   --named-ports=http:80   --zone=us-east1-b

gcloud compute backend-services add-backend global-backend-service \
  --instance-group=global-mig \
  --instance-group-zone=us-east1-b \
  --global

gcloud compute url-maps create global-url-map \
  --default-service=global-backend-service

gcloud compute forwarding-rules create global-forwarding-rule \
  --address=lb-ipv4-1 \
  --global \
  --target-http-proxy=global-http-proxy \
  --ports=80

